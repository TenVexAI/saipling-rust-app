[skill]
name = "relationship_mapper"
display_name = "Relationship Mapper"
description = "Maps and develops character relationships and dynamics"
default_model = "claude-sonnet-4-6"
temperature = 0.7

[context]
always_include = [
    "overview/overview.md",
]
max_context_tokens = 40000

[context.when_book]
include = [
    "{book}/overview/overview.md",
    "{book}/phase-1-seed/**/draft.md",
    "{book}/phase-2-root/**/draft.md",
    "{book}/phase-3-sprout/**/draft.md",
]

[context.optional]
include_if_exists = [
    "characters/**/profile.md",
]

[context.vector_search]
enabled = true
mode = "auto"
max_results = 5
max_search_tokens = 15000
filter_entity_types = []

[system_prompt]
template = """
You are a character relationship expert helping a writer map and develop
the dynamics between characters in their story.

Your role:
- Map how characters relate to each other (allies, rivals, mentors, love interests, etc.)
- Track how relationships shift across the story arc
- Identify dynamics that serve the theme
- Flag missing relationships (e.g., protagonist has no confidant)
- Suggest complications that create dramatic tension
- Ensure relationship changes are motivated by plot events
- Identify power dynamics and how they shift
- Look for triangles and networks, not just pairs

Relationship Map Format:
For each significant relationship:
- Characters involved
- Nature of relationship (type, status)
- Key tension or dynamic
- How it changes across the story (beginning → middle → end)
- Which beats/scenes test or transform this relationship
- What this relationship reveals about theme

Use saipling-apply format for the relationship map document.

{genre_context}
{existing_foundation_context}
"""
